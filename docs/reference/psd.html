<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Phylogenetic Species Diversity Metrics — psv • phyr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Phylogenetic Species Diversity Metrics — psv"><meta property="og:description" content="Calculate the bounded phylogenetic biodiversity metrics:
phylogenetic species variability, richness, evenness and clustering for one or multiple communities."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phyr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/benchmarks.html">Performance benchmark</a>
    </li>
    <li>
      <a href="../articles/pglmm.html">Usage of pglmm()</a>
    </li>
    <li>
      <a href="../articles/phyr_example_empirical.html">pglmm example with empirical data</a>
    </li>
    <li>
      <a href="../articles/plot-re.html">Plot random terms of communityPGLMM</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/daijiang/phyr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Phylogenetic Species Diversity Metrics</h1>
    <small class="dont-index">Source: <a href="https://github.com/daijiang/phyr/blob/HEAD/R/psv.R" class="external-link"><code>R/psv.R</code></a></small>
    <div class="hidden name"><code>psd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate the bounded phylogenetic biodiversity metrics:
phylogenetic species variability, richness, evenness and clustering for one or multiple communities.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">psv</span><span class="op">(</span></span>
<span>  <span class="va">comm</span>,</span>
<span>  <span class="va">tree</span>,</span>
<span>  compute.var <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale.vcv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prune.tree <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cpp <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">psr</span><span class="op">(</span></span>
<span>  <span class="va">comm</span>,</span>
<span>  <span class="va">tree</span>,</span>
<span>  compute.var <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale.vcv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prune.tree <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cpp <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pse</span><span class="op">(</span><span class="va">comm</span>, <span class="va">tree</span>, scale.vcv <span class="op">=</span> <span class="cn">TRUE</span>, prune.tree <span class="op">=</span> <span class="cn">FALSE</span>, cpp <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">psc</span><span class="op">(</span><span class="va">comm</span>, <span class="va">tree</span>, scale.vcv <span class="op">=</span> <span class="cn">TRUE</span>, prune.tree <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">psv.spp</span><span class="op">(</span><span class="va">comm</span>, <span class="va">tree</span>, scale.vcv <span class="op">=</span> <span class="cn">TRUE</span>, prune.tree <span class="op">=</span> <span class="cn">FALSE</span>, cpp <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">psd</span><span class="op">(</span></span>
<span>  <span class="va">comm</span>,</span>
<span>  <span class="va">tree</span>,</span>
<span>  compute.var <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale.vcv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prune.tree <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cpp <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>comm</dt>
<dd><p>Community data matrix, site as rows and species as columns, site names as row names.</p></dd>


<dt>tree</dt>
<dd><p>A phylo tree object with class "phylo" or a phylogenetic covariance matrix.</p></dd>


<dt>compute.var</dt>
<dd><p>Logical, default is TRUE, computes the expected variances
for PSV and PSR for each community.</p></dd>


<dt>scale.vcv</dt>
<dd><p>Logical, default is TRUE, scale the phylogenetic covariance
matrix to bound the metric between 0 and 1 (i.e. correlations).</p></dd>


<dt>prune.tree</dt>
<dd><p>Logical, default is FALSE, prune the phylogeny before converting
to var-cov matrix? Pruning and then converting VS converting then subsetting may
have different var-cov matrix resulted.</p></dd>


<dt>cpp</dt>
<dd><p>Logical, default is TRUE, whether to use cpp for internal calculations.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns a dataframe of the respective phylogenetic species diversity metric values</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><em>Phylogenetic species variability (PSV)</em> quantifies how
phylogenetic relatedness decreases the variance of a hypothetical
unselected/neutral trait shared by all species in a community.
The expected value of PSV is statistically independent of species richness,
is one when all species in a community are unrelated (i.e., a star phylogeny)
and approaches zero as species become more related. PSV is directly related
to mean phylogenetic distance, except except calculated on a scaled phylogenetic
covariance matrix. The expected variance around PSV for any community of a particular
species richness can be approximated. To address how individual species
contribute to the mean PSV of a data set, the function <code>psv.spp</code> gives
signed proportions of the total deviation from the mean PSV that occurs when
all species are removed from the data set one at a time. The absolute values
of these “species effects” tend to positively correlate with species prevalence.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>These metrics are bounded either between zero and one (PSV, PSE, PSC)
or zero and species richness (PSR); but the metrics asymptotically approach
zero as relatedness increases. Zero can be assigned to communities with less
than two species, but conclusions drawn from assigning communities zero values
need be carefully explored for any data set. The data sets need not be
species-community data sets but may be any community data set with an associated phylogeny.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Helmus M.R., Bland T.J., Williams C.K. &amp; Ives A.R. 2007.
Phylogenetic measures of biodiversity. American Naturalist, 169, E68-E83</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Matthew Helmus <a href="mailto:mrhelmus@gmail.com">mrhelmus@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">psv</span><span class="op">(</span>comm <span class="op">=</span> <span class="va">comm_a</span>, tree <span class="op">=</span> <span class="va">phylotree</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            PSVs SR        vars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3293        NA  1          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3294 0.7294797  5 0.002882626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3295 0.7937525  6 0.001787660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3296 0.8998803  4 0.005107335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3297 0.7831887  4 0.005107335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3299 0.7664551  5 0.002882626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3300 0.8085234  6 0.001787660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3301 0.7167665  2 0.033698666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3302 0.6987934  4 0.005107335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3303 0.8083833  2 0.033698666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3304 0.7645509  3 0.010756048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3307 0.8534491  5 0.002882626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3308 0.6796509  5 0.002882626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3309 0.7469461  3 0.010756048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s3311 0.7706318  5 0.002882626</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Anthony Ives, Russell Dinnage, Lucas A. Nell, Matthew Helmus, Daijiang Li.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

